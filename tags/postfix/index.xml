<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Postfix on VaLouille</title><link>https://valouille.github.io/tags/postfix/</link><description>Recent content in Postfix on VaLouille</description><generator>Hugo</generator><language>fr</language><copyright>Valérian Beaudoin</copyright><lastBuildDate>Thu, 04 Sep 2014 09:57:02 +0000</lastBuildDate><atom:link href="https://valouille.github.io/tags/postfix/index.xml" rel="self" type="application/rss+xml"/><item><title>Mettre en place une limite sur le nombre de mails envoyés par IP sur Postfix</title><link>https://valouille.github.io/2014/09/mettre-en-place-une-limite-sur-le-nombre-de-mails-envoyes-par-ip-sur-postfix/</link><pubDate>Thu, 04 Sep 2014 09:57:02 +0000</pubDate><guid>https://valouille.github.io/2014/09/mettre-en-place-une-limite-sur-le-nombre-de-mails-envoyes-par-ip-sur-postfix/</guid><description>Dans Postfix, on a la possibilité de paramétrer une limite du nombre de mails envoyés sur une intervalle de temps. Par exemple, pour mettre en place une limite de 10 mails envoyés par minutes, on ajoute les lignes suivantes au fichier /etc/postfix/main.cf :
# Whitelist smtpd_client_event_limit_exceptions = 127.0.0.0/8 # Max 10 mails/IP/anvil_rate_time_unit smtpd_client_message_rate_limit = 10 # Reject pipelining (speed-up mail sending) smtpd_data_restrictions = reject_unauth_pipelining smtpd_delay_reject = yes # Reset counter each minute anvil_rate_time_unit = 60s # Log statistics each 5 minutes anvil_status_update_time = 600s Pour activer les modifications :</description></item><item><title>Changer l'adresse ou le domaine de destination dans Postfix</title><link>https://valouille.github.io/2014/05/changer-ladresse-ou-le-domaine-de-destination-dans-postfix/</link><pubDate>Wed, 14 May 2014 15:57:33 +0000</pubDate><guid>https://valouille.github.io/2014/05/changer-ladresse-ou-le-domaine-de-destination-dans-postfix/</guid><description>Pour modifier l’adresse de destination des mails envoyés dans Postfix, il faut passer par trivial-rewrite. Pour ce faire, il faut ajouter dans le fichier /etc/postfix/main.cf :
smtp_generic_maps = regexp:/etc/postfix/generic Ensuite, dans le fichier /etc/postfix/generic
/^.*@domain1.com/ user1@domain1.com # renvoyer le domaine vers un utilisateur spécifique /^.*@domain1.com/ $1@domain2.com # renvoyer les mails de l&amp;#39;utilisateur de domain1.com vers domain2.com /^.*@.*/ user1@domain1.com # tout renvoyer vers user1@domain1.com Pour activer la configuration :
postmap /etc/postfix/generic /etc/init.</description></item><item><title>Commandes utiles pour Postfix</title><link>https://valouille.github.io/2014/04/commandes-utiles-pour-postfix/</link><pubDate>Fri, 18 Apr 2014 15:21:10 +0000</pubDate><guid>https://valouille.github.io/2014/04/commandes-utiles-pour-postfix/</guid><description>Voir quels domaines ont beaucoup de mails deferred en réception : qshape deferred Voir quels domaines ont beaucoup de mails actifs en émission : qshape -s active Supprimer tous les mails dans « Deferred » postsuper -d ALL deferred Supprimer tous les mails en queue postsuper -d ALL Supprimer un mail spécifique postsuper -d DA80E24A0A Voir le contenu d’un mail dans la queue postcat -q F1F942D236 Supprimer les mails de la queue en fonction de l’expéditeur ou du destinataire mailq | tail -n+2 | awk &amp;#39;BEGIN { RS = &amp;#34;&amp;#34; } { if ($8 == &amp;#34;www-data@exemple.</description></item><item><title>Empêcher les mails d'être délivrés</title><link>https://valouille.github.io/2014/03/empecher-les-mails-detre-delivres/</link><pubDate>Fri, 28 Mar 2014 13:36:14 +0000</pubDate><guid>https://valouille.github.io/2014/03/empecher-les-mails-detre-delivres/</guid><description>Afin d’empêcher les mails de certains domaines d’être délivrés, par exemple en cas de maintenance ou de migration du domaine, on peut laisser ces mails dans la queue en les mettant en status « HOLD » dans postfix.
Pour passer un domaine en HOLD, il faut modifier le fichier /etc/postfix/main.cf tel que ci-dessous et redémarrer postfix :
smtpd_recipient_restrictions = ... check_recipient_access hash:/etc/postfix/hold Ensuite on ajoute les lignes suivantes dans le fichier /etc/postfix/hold :</description></item><item><title>Installer OpenDKIM avec Postfix</title><link>https://valouille.github.io/2013/10/installer-opendkim-avec-postfix/</link><pubDate>Thu, 24 Oct 2013 12:42:05 +0000</pubDate><guid>https://valouille.github.io/2013/10/installer-opendkim-avec-postfix/</guid><description>DKIM permet d’authentifier le nom de domaine de l’expéditeur d’un mail. Cela peut être utile pour ajouter de la fiabilité à ses mails et ainsi éviter qu’ils se trouvent classés comme « spam ».
DKIM s’installe à côté et se couple à Postfix. Voici la procédure pour installer opendkim, et ainsi authentifier les mails qui seront envoyés, à supposer que postfix est déjà fonctionnel.
On installe opendkim
apt-get install opendkim On met en place la configuration dans le fichier /etc/opendkim.</description></item></channel></rss>