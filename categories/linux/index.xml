<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>linux on VaLouille</title><link>https://valouille.github.io/categories/linux/</link><description>Recent content in linux on VaLouille</description><generator>Hugo -- gohugo.io</generator><language>fr</language><copyright>Valérian Beaudoin</copyright><lastBuildDate>Mon, 29 Jan 2018 13:07:06 +0000</lastBuildDate><atom:link href="https://valouille.github.io/categories/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>Utiliser ovftool sous linux avec un domaine</title><link>https://valouille.github.io/2018/01/utiliser-ovftool-sous-linux-avec-un-domaine/</link><pubDate>Mon, 29 Jan 2018 13:07:06 +0000</pubDate><guid>https://valouille.github.io/2018/01/utiliser-ovftool-sous-linux-avec-un-domaine/</guid><description>J’ai suivi la documentation officielle pour exporter une VM en OVA avec ovftool, mais j’ai été confronté aux erreurs suivantes :
Sans quotes :
# ovftool --noSSLVerify vi://vsphere.local\administrator@vcenter.fqdn/DC/vm/web1 web1_export.ova Enter login information for source vi://vcenter.fqdn/ Username: vsphere.localadministrator Password: Terminate process signal received - aborting operation Removing temporary objects and files *Error: Execution aborted Completed with errors Avec quotes :
# ovftool --noSSLVerify &amp;#34;vi://vsphere.local\administrator@vcenter.fqdn/DC/vm/web1&amp;#34; web1_export.ova Error: Internal error: Failed to connect to server Completed with errors La solution que j’ai trouvé consiste à remplacer le backslash par le code hexadécimal correspondant : %5c</description></item><item><title>Corriger l'erreur 106 Illegal character in VCL name (‘:’) avec Varnish 5</title><link>https://valouille.github.io/2018/01/corriger-lerreur-106-illegal-character-in-vcl-name-avec-varnish-5/</link><pubDate>Thu, 04 Jan 2018 15:31:45 +0000</pubDate><guid>https://valouille.github.io/2018/01/corriger-lerreur-106-illegal-character-in-vcl-name-avec-varnish-5/</guid><description>J’ai été confronté à l’erreur suivante lors du reload du démon varnish :
Wr 200 PONG 1515077296 1.0 Rd vcl.load root:1515087296.307831546 /etc/varnish/default.vcl Wr 106 Illegal character in VCL name (&amp;#39;:&amp;#39;) Ce problème provient du fichier /usr/share/varnish/reload-vcl qui n’est pas écrasé par les version 5.0 ou 5.1 de varnish lorsqu’on met à jour. Les lignes suivantes génèrent un fichier vcl avec un nom qui n’est plus pris en compte par Varnish :</description></item><item><title>Corriger l'erreur gpg: [don't know]: invalid packet</title><link>https://valouille.github.io/2017/12/corriger-lerreur-gpg-dont-know-invalid-packet/</link><pubDate>Thu, 28 Dec 2017 16:40:07 +0000</pubDate><guid>https://valouille.github.io/2017/12/corriger-lerreur-gpg-dont-know-invalid-packet/</guid><description>J’ai été confronté à l’erreur suivante en essayant d’ajouter une clé GPG à APT :
~ # apt-key add keyring.gpg gpg: [don&amp;#39;t know]: invalid packet (ctb=2d) gpg: keyring_get_keyblock: read error: Invalid packet gpg: keydb_get_keyblock failed: Invalid keyring gpg: [don&amp;#39;t know]: invalid packet (ctb=2d) gpg: /tmp/apt-key-gpghome.kpq2RJAPsu/pubring.gpg: copy to &amp;#39;/tmp/apt-key-gpghome.kpq2RJAPsu/pubring.gpg.tmp&amp;#39; failed: Invalid packet gpg: error writing keyring &amp;#39;/tmp/apt-key-gpghome.kpq2RJAPsu/pubring.gpg&amp;#39;: Invalid packet gpg: [don&amp;#39;t know]: invalid packet (ctb=2d) gpg: keyring_get_keyblock: read error: Invalid packet gpg: error reading keyblock: Invalid keyring gpg: error reading &amp;#39;keyring.</description></item><item><title>Résoudre l'erreur « SOAP request error – possibly a protocol issue » qui apparaît avec le SDK Perl de VMWare</title><link>https://valouille.github.io/2015/08/resoudre-lerreur-soap-request-error-possibly-a-protocol-issue-qui-apparait-avec-le-sdk-perl-de-vmware/</link><pubDate>Fri, 28 Aug 2015 12:56:50 +0000</pubDate><guid>https://valouille.github.io/2015/08/resoudre-lerreur-soap-request-error-possibly-a-protocol-issue-qui-apparait-avec-le-sdk-perl-de-vmware/</guid><description>Si vous utilisez le SDK Perl de VMWare, il est possible que vous ayez été confronté à cette erreur :
SOAP request error - possibly a protocol issue: xmlns:soapenv=&amp;#34;http://schemas.xmlsoap.org/soap/envelope/&amp;#34; xmlns:xsd=&amp;#34;http://www.w3.org/2001/XMLSchema&amp;#34; xmlns:xsi=&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34;&amp;gt; Le souci provient de la lib LWP (libwww-perl) qui possède un bug à partir de la version 6.04 qui a été corrigé à la version 6.06 mais seulement pour IO::Socket::SSL, mais le SDK Perl de VMWare utilise Crypt::SSLeay.
Pour vérifier la version de la lib, il faut utiliser la commande suivante :</description></item><item><title>Compiler un module PECL en paquet Debian</title><link>https://valouille.github.io/2014/10/compiler-un-module-pecl-en-paquet-debian/</link><pubDate>Fri, 17 Oct 2014 08:48:55 +0000</pubDate><guid>https://valouille.github.io/2014/10/compiler-un-module-pecl-en-paquet-debian/</guid><description>Voici la procédure pour générer un .deb à partir d’un .tar.gz PECL de la façon la plus simple qui soit.
On aura besoin d’utiliser dh-make-pecl pour générer le répertoire debian :
apt-get install dh-make-php php5-dev ubuntu-dev-tools build-essential On choisit le nom et l’adresse mail du mainteneur du paquet
export DEBFULLNAME=&amp;#34;Valerian Beaudoin&amp;#34; export DEBEMAIL=&amp;#34;mail@domaine.com&amp;#34; On télécharge l’extension PECL qui nous intéresse :
wget http://pecl.php.net/get/apcu-4.0.7.tgz Puis on utilise dh-make-pecl qui va générer les fichiers debian/control, debian/rules … :</description></item><item><title>Mettre en place une limite sur le nombre de mails envoyés par IP sur Postfix</title><link>https://valouille.github.io/2014/09/mettre-en-place-une-limite-sur-le-nombre-de-mails-envoyes-par-ip-sur-postfix/</link><pubDate>Thu, 04 Sep 2014 09:57:02 +0000</pubDate><guid>https://valouille.github.io/2014/09/mettre-en-place-une-limite-sur-le-nombre-de-mails-envoyes-par-ip-sur-postfix/</guid><description>Dans Postfix, on a la possibilité de paramétrer une limite du nombre de mails envoyés sur une intervalle de temps. Par exemple, pour mettre en place une limite de 10 mails envoyés par minutes, on ajoute les lignes suivantes au fichier /etc/postfix/main.cf :
# Whitelist smtpd_client_event_limit_exceptions = 127.0.0.0/8 # Max 10 mails/IP/anvil_rate_time_unit smtpd_client_message_rate_limit = 10 # Reject pipelining (speed-up mail sending) smtpd_data_restrictions = reject_unauth_pipelining smtpd_delay_reject = yes # Reset counter each minute anvil_rate_time_unit = 60s # Log statistics each 5 minutes anvil_status_update_time = 600s Pour activer les modifications :</description></item><item><title>Installer Dell Powervault MD Storage Software (SMcli …) sous Debian</title><link>https://valouille.github.io/2014/08/installer-dell-powervault-md-storage-software-smcli/</link><pubDate>Wed, 27 Aug 2014 16:23:15 +0000</pubDate><guid>https://valouille.github.io/2014/08/installer-dell-powervault-md-storage-software-smcli/</guid><description>Voici la procédure pour installer SMclient sous Debian en passant par des paquets .DEB :
Java doit être installé :
apt-get install openjdk-7-jre Télécharger le ressource CD/DVD sur le site de Dell (Actuellement : DELL_MDSS_Consolidated_RDVD_5_1_0_9.iso)
Le monter :
mount DELL_MDSS_Consolidated_RDVD_5_1_0_9.iso /mnt On copie les fichiers qui nous intéressent :
mkdir ~/dell_mdss cp /mnt/linux/mdsm/* ~/dell_mdss cd ~/dell_mdss On crée le lien necessaire pour l’exécution du binaire :
ln -s /lib/x86_64-linux-gnu/libc.so.6 /lib/libc.so.6 On lance le binaire :</description></item><item><title>Scripts pour générer la liste des jours fériés en France et des week-ends</title><link>https://valouille.github.io/2014/05/scripts-pour-generer-la-liste-des-jours-feries-en-france-et-des-week-ends/</link><pubDate>Wed, 28 May 2014 15:41:47 +0000</pubDate><guid>https://valouille.github.io/2014/05/scripts-pour-generer-la-liste-des-jours-feries-en-france-et-des-week-ends/</guid><description>Voici deux scripts que j’ai créé qui permettent de générer la liste des jours fériés en France (hors Alsace/Moselle et DOM/TOM), ainsi que les jour qui tombent un samedi ou un dimanche.
Cela peut être très pratique pour éviter de lancer certains scripts ces jours là.
– La liste des jours fériés :
Certains jours tombent à des dates fixes, ce qui est pratique, mais 3 jours fériés ont une date variable.</description></item><item><title>Changer l'adresse ou le domaine de destination dans Postfix</title><link>https://valouille.github.io/2014/05/changer-ladresse-ou-le-domaine-de-destination-dans-postfix/</link><pubDate>Wed, 14 May 2014 15:57:33 +0000</pubDate><guid>https://valouille.github.io/2014/05/changer-ladresse-ou-le-domaine-de-destination-dans-postfix/</guid><description>Pour modifier l’adresse de destination des mails envoyés dans Postfix, il faut passer par trivial-rewrite. Pour ce faire, il faut ajouter dans le fichier /etc/postfix/main.cf :
smtp_generic_maps = regexp:/etc/postfix/generic Ensuite, dans le fichier /etc/postfix/generic
/^.*@domain1.com/ user1@domain1.com # renvoyer le domaine vers un utilisateur spécifique /^.*@domain1.com/ $1@domain2.com # renvoyer les mails de l&amp;#39;utilisateur de domain1.com vers domain2.com /^.*@.*/ user1@domain1.com # tout renvoyer vers user1@domain1.com Pour activer la configuration :
postmap /etc/postfix/generic /etc/init.</description></item><item><title>Convertir un fichier toc/bin en image ISO</title><link>https://valouille.github.io/2014/04/convertir-un-fichier-tocbin-en-image-iso/</link><pubDate>Sat, 19 Apr 2014 22:15:56 +0000</pubDate><guid>https://valouille.github.io/2014/04/convertir-un-fichier-tocbin-en-image-iso/</guid><description>Brasero (via cdrdao) génère des images disque sous forme de fichiers .toc/.bin.
Pour les convertir, voici la procédure :
Sous Linux : apt-get install cdrdao bchunk Sous Mac : sudo port install cdrdao bchunk Ensuite il faut convertir le fichier .toc en fichier .cue :
toc2cue fichier.toc fichier.cue Puis on peut à partir de ces deux fichiers générer une image ISO :
bchunk fichier.bin fichier.cue fichier.iso</description></item><item><title>Commandes utiles pour Postfix</title><link>https://valouille.github.io/2014/04/commandes-utiles-pour-postfix/</link><pubDate>Fri, 18 Apr 2014 15:21:10 +0000</pubDate><guid>https://valouille.github.io/2014/04/commandes-utiles-pour-postfix/</guid><description>Voir quels domaines ont beaucoup de mails deferred en réception : qshape deferred Voir quels domaines ont beaucoup de mails actifs en émission : qshape -s active Supprimer tous les mails dans « Deferred » postsuper -d ALL deferred Supprimer tous les mails en queue postsuper -d ALL Supprimer un mail spécifique postsuper -d DA80E24A0A Voir le contenu d’un mail dans la queue postcat -q F1F942D236 Supprimer les mails de la queue en fonction de l’expéditeur ou du destinataire mailq | tail -n+2 | awk &amp;#39;BEGIN { RS = &amp;#34;&amp;#34; } { if ($8 == &amp;#34;www-data@exemple.</description></item><item><title>Réparer DPKG/APT quand rien ne va plus</title><link>https://valouille.github.io/2014/04/reparer-dpkgapt-quand-rien-ne-va-plus/</link><pubDate>Thu, 10 Apr 2014 14:02:31 +0000</pubDate><guid>https://valouille.github.io/2014/04/reparer-dpkgapt-quand-rien-ne-va-plus/</guid><description>J’ai récemment eu les erreurs suivantes :
dpkg: regarding .../libgcc1_1%3a4.7.2-5_amd64.deb containing libgcc1:amd64, pre-dependency problem: libgcc1 pre-depends on multiarch-support multiarch-support is unpacked, but has never been configured. dpkg: error processing /var/cache/apt/archives/libgcc1\_1%3a4.7.2-5\_amd64.deb (&amp;amp;#8211;install): pre-dependency problem &amp;amp;#8211; not installing libgcc1:amd64 Preparing to replace libc6:amd64 2.13-38+deb7u1 (using .../libc6_2.13-38+deb7u1_amd64.deb) ... dpkg: error processing /var/cache/apt/archives_old/libc6_2.13-38+deb7u1_amd64.deb (--install): subprocess new pre-installation script returned error exit status 2 Setting up multiarch-support (2.13-38+deb7u1) ... Setting up libgcc1:amd64 (1:4.7.2-5) ... Errors were encountered while processing: /var/cache/apt/archives/libc6_2.</description></item><item><title>Empêcher les mails d'être délivrés</title><link>https://valouille.github.io/2014/03/empecher-les-mails-detre-delivres/</link><pubDate>Fri, 28 Mar 2014 13:36:14 +0000</pubDate><guid>https://valouille.github.io/2014/03/empecher-les-mails-detre-delivres/</guid><description>Afin d’empêcher les mails de certains domaines d’être délivrés, par exemple en cas de maintenance ou de migration du domaine, on peut laisser ces mails dans la queue en les mettant en status « HOLD » dans postfix.
Pour passer un domaine en HOLD, il faut modifier le fichier /etc/postfix/main.cf tel que ci-dessous et redémarrer postfix :
smtpd_recipient_restrictions = ... check_recipient_access hash:/etc/postfix/hold Ensuite on ajoute les lignes suivantes dans le fichier /etc/postfix/hold :</description></item><item><title>Créer un repository Debian signé avec Freight</title><link>https://valouille.github.io/2014/03/creer-un-depot-debian-signe-avec-freight/</link><pubDate>Thu, 20 Mar 2014 10:40:20 +0000</pubDate><guid>https://valouille.github.io/2014/03/creer-un-depot-debian-signe-avec-freight/</guid><description>Reprepro ne permet pas d’avoir plusieurs versions d’un même paquet dans son dépôt. Pour contourner cette limitation, je suis donc passé à Freight.
Freight :
permet d’ajouter des .deb directement sans fichier .changes signe à la volée les paquets autorise plusieurs versions d’un même paquet permet d’avoir plusieurs branches est très simple à installer et à maintenir est très léger et n’a pas besoin de base SQL L’installation est ultra simple :</description></item><item><title>Résoudre l'erreur SSL 42 avec thunderbird</title><link>https://valouille.github.io/2014/02/resoudre-lerreur-ssl-42-avec-thunderbird/</link><pubDate>Mon, 24 Feb 2014 11:02:30 +0000</pubDate><guid>https://valouille.github.io/2014/02/resoudre-lerreur-ssl-42-avec-thunderbird/</guid><description>Quand on essaie d’utiliser Thunderbird pour se connecter sur un Dovecot en IMAPS, il se peut que l’on se retrouver avec l’erreur ci-dessous dans le syslog sur serveur web si le certificat est auto-signé ou invalide :
dovecot: imap-login: Disconnected (no auth attempts in 1 secs): user=&amp;lt;&amp;gt;, rip=192.168.0.01, lip=10.10.10.62, TLS: SSL_read() failed: error:14094412:SSL routines:SSL3_READ_BYTES:sslv3 a lert bad certificate: SSL alert number 42, session=&amp;lt;W2RIsxSzFADAqAM9&amp;gt; Cette erreur est générée car Thunderbird n’affiche pas la fenêtre permettant d’accepter un certificat non valide pendant la phase d’auto-configuration d’une adresse de courriel.</description></item><item><title>Activer vacation et le faire fonctionner avec roundcube 0.9 et postfixadmin</title><link>https://valouille.github.io/2014/02/activer-vacation-et-le-faire-fonctionner-avec-roundcube-0-9-et-postfixadmin/</link><pubDate>Wed, 19 Feb 2014 11:17:21 +0000</pubDate><guid>https://valouille.github.io/2014/02/activer-vacation-et-le-faire-fonctionner-avec-roundcube-0-9-et-postfixadmin/</guid><description>Voici la procédure pour activer le plugin vacation et le faire fonctionner avec les nouvelles versions de roundcube 0.8.*. domain.com est à changer par un domain qui existe vraiment sur la machine. Ce n’est pas la même procédure qu’avant, car avec les nouvelles versions de roundcube, les anciens plugins ne fonctionnent plus. Celui-ci a été modifié et traduit.
groupadd --gid 10002 vacation useradd -o -d /var/spool/vacation -g 10002 -u 10002 -s /bin/false vacation Ensuite, créer un dossier pour vacation</description></item><item><title>Utiliser rsync + SSH avec un port différent de 22</title><link>https://valouille.github.io/2013/12/utiliser-rsync-ssh-avec-un-port-different-de-22/</link><pubDate>Thu, 19 Dec 2013 10:10:50 +0000</pubDate><guid>https://valouille.github.io/2013/12/utiliser-rsync-ssh-avec-un-port-different-de-22/</guid><description>Pour utiliser rsync + SSH vers un autre port que le port par défaut, on utilise la commande suivante :
rsync -av -e &amp;#39;ssh -p &amp;lt;PORT&amp;gt;&amp;#39; root@IP.IP.IP.IP:/dossier/source /dossier/destination Par exemple avec le port 2222 :
rsync -av -e &amp;#39;ssh -p 2222&amp;#39; root@IP.IP.IP.IP:/dossier/source /dossier/destination</description></item><item><title>Nettoyer les logs IPMI sous linux en ligne de commande</title><link>https://valouille.github.io/2013/12/nettoyer-les-logs-ipmi-sous-linux-en-ligne-de-commande/</link><pubDate>Mon, 16 Dec 2013 12:53:45 +0000</pubDate><guid>https://valouille.github.io/2013/12/nettoyer-les-logs-ipmi-sous-linux-en-ligne-de-commande/</guid><description>Les logs systèmes sur les serveurs Dell peuvent ne plus s’écrire au bout d’un certain temps. En effet, l’espace est limité.
Les erreurs en résultant seront de la forme :
Event Logging Disabled #0x72 | Log full | Asserted ou
ESM log is 100% full On peut utiliser la commande ipmitool suivante pour les effacer, et ainsi permettre à nouveau l’écriture des logs :
ipmitool sel clear</description></item><item><title>Installer OpenDKIM avec Postfix</title><link>https://valouille.github.io/2013/10/installer-opendkim-avec-postfix/</link><pubDate>Thu, 24 Oct 2013 12:42:05 +0000</pubDate><guid>https://valouille.github.io/2013/10/installer-opendkim-avec-postfix/</guid><description>DKIM permet d’authentifier le nom de domaine de l’expéditeur d’un mail. Cela peut être utile pour ajouter de la fiabilité à ses mails et ainsi éviter qu’ils se trouvent classés comme « spam ».
DKIM s’installe à côté et se couple à Postfix. Voici la procédure pour installer opendkim, et ainsi authentifier les mails qui seront envoyés, à supposer que postfix est déjà fonctionnel.
On installe opendkim
apt-get install opendkim On met en place la configuration dans le fichier /etc/opendkim.</description></item><item><title>Créer un paquet Debian vide</title><link>https://valouille.github.io/2013/10/creer-un-paquet-debian-vide/</link><pubDate>Mon, 14 Oct 2013 09:49:31 +0000</pubDate><guid>https://valouille.github.io/2013/10/creer-un-paquet-debian-vide/</guid><description>Pour créer un « dummy package », c’est à dire un paquet Debian vide qui peut être utile pour satisfaire des dépendances, on utilise equivs. Par exemple, pour libkrb53
apt-get install equivs equivs-control libkrb53 Cela va créer un fichier libkrb53. On l’édite :
Section: misc Priority: optional Standards-Version: 2.9.2 Package: libkrb53 Version: 1.9.1 Maintainer: Valerian Beaudoin Architecture: all Description: Dummy libkrb53 package Puis on le construit et on l’installe
equivs-build libkrb53 dpkg -i libkrb53_1.</description></item><item><title>Réinstaller les fichiers de configuration par défaut d'un paquet debian</title><link>https://valouille.github.io/2013/08/reinstaller-les-fichiers-de-configuration-par-defaut-dun-paquet-debian/</link><pubDate>Fri, 09 Aug 2013 09:49:06 +0000</pubDate><guid>https://valouille.github.io/2013/08/reinstaller-les-fichiers-de-configuration-par-defaut-dun-paquet-debian/</guid><description>Si on a modifié des fichiers de configuration d’un paquet debian et que l’on souhaite remettre les fichiers de configuration originaux, voici la démarche à suivre :
On vérifie que le(s) fichier(s) de configuration sont bien dans le paquet
dpkg --status &amp;lt;paquet&amp;gt; Exemple avec puppet :
Conffiles: /etc/init.d/puppet 79dec4169533326b9e1a21aac681d8e8 /etc/default/puppet 9e5a0cf174ccff1af10342297b8b1bdb Si je veux remettre le fichier /etc/init.d/puppet par défaut, il faut que je le renomme :
mv /etc/init.d/puppet /etc/init.d/puppet.broken Ensuite, je le réinstalle</description></item><item><title>Compiler un module Perl/CPAN en paquet Debian</title><link>https://valouille.github.io/2013/08/compiler-un-module-perlcpan-en-paquet-debian/</link><pubDate>Tue, 06 Aug 2013 09:42:27 +0000</pubDate><guid>https://valouille.github.io/2013/08/compiler-un-module-perlcpan-en-paquet-debian/</guid><description>Voici la procédure pour générer un .deb à partir d’un .tar.gz de la façon la plus simple qui soit.
On aura besoin d’utiliser dh-make-perl pour générer le repertoire debian, ainsi que d’apt-file :
apt-get install dh-make-perl apt-file devscripts build-essential On met à jour apt-file :
apt-file update Ensuite, on télécharge le module que l’on souhaite installer :
wget http://search.cpan.org/CPAN/authors/id/T/TO/TOKUHIROM/FCGI-Client-0.08.tar.gz On l’extrait :
tar xvzf FCGI-Client-0.08.tar.gz Puis on utilise dh-make-perl qui va générer les fichiers debian/control, debian/rules … :</description></item><item><title>Créer un dépôt Debian signé « The Debian Way ! »</title><link>https://valouille.github.io/2013/07/creer-un-depot-debian-signe-the-debian-way/</link><pubDate>Mon, 29 Jul 2013 15:57:53 +0000</pubDate><guid>https://valouille.github.io/2013/07/creer-un-depot-debian-signe-the-debian-way/</guid><description>Voici la procédure permettant de créer un dépôt Debian signé avec des paquets signés.
Il faut tout d’abord générer une clé GPG :
apt:~# gpg --gen-key gpg (GnuPG) 1.4.12; Copyright (C) 2012 Free Software Foundation, Inc. This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Sélectionnez le type de clef désiré : (1) RSA et RSA (par défaut) (2) DSA et Elgamal (3) DSA (signature seule) (4) RSA (signature seule) Quel est votre choix ?</description></item><item><title>Comment générer de l'entropie</title><link>https://valouille.github.io/2013/07/comment-generer-de-lentropie/</link><pubDate>Mon, 29 Jul 2013 13:24:38 +0000</pubDate><guid>https://valouille.github.io/2013/07/comment-generer-de-lentropie/</guid><description>Quand j’ai essayé de créer une clé GPG sur une machine fraichement installé, j’ai été confronté au message suivant :
De nombreux octets aléatoires doivent être générés. Vous devriez faire autre chose (taper au clavier, déplacer la souris, utiliser les disques) pendant la génération de nombres premiers ; cela donne au générateur de nombres aléatoires une meilleure chance d&amp;#39;obtenir suffisamment d&amp;#39;entropie. Afin de voir l’entropie disponible, on peut utiliser la commande suivante :</description></item><item><title>Installer HAproxy sous Debian Wheezy</title><link>https://valouille.github.io/2013/06/installer-haproxy-sous-debian-wheezy/</link><pubDate>Wed, 05 Jun 2013 14:32:23 +0000</pubDate><guid>https://valouille.github.io/2013/06/installer-haproxy-sous-debian-wheezy/</guid><description>HAproxy n’est plus dans les depots Debian Wheezy, car l’équipe n’avait pas corrigé certains bugs.
Il est cependant possible de l’installer en ajoutant les backports. Pour cela, simplement ajouter la ligne suivante dans le fichier /etc/apt/sources.list :
deb http://ftp.debian.org/debian/ wheezy-backports main Et :
apt-get update ; apt-get install haproxy</description></item><item><title>Corriger la faille kernel CVE-2013-2094 sans reboot sous Debian</title><link>https://valouille.github.io/2013/05/corriger-la-faille-kernel-cve-2013-2094-sans-reboot-sous-debian/</link><pubDate>Tue, 21 May 2013 13:36:11 +0000</pubDate><guid>https://valouille.github.io/2013/05/corriger-la-faille-kernel-cve-2013-2094-sans-reboot-sous-debian/</guid><description>L’exploit CVE-2013-2094 permet d’exploiter une faille dans la perf_swevent_init function du fichier kernel/events/core.c du noyau Linux, entre les versions 2.6.37 et 3.8.8. Cet exploit permet de passer root.
Pour voir si le noyau utilisé est vulnérable, on peut utiliser la commande suivante :
grep CONFIG_PERF_EVENTS /boot/config-`uname -r` Si la commande renvoie la ligne suivante, et que la version du noyau est comprise entre 2.6.37 et 3.8.8, alors le noyau est vulnérable :</description></item><item><title>Compiler un paquet Debian DKMS pour un module noyau</title><link>https://valouille.github.io/2013/05/compiler-un-paquet-debian-dkms-pour-un-module-noyau/</link><pubDate>Tue, 21 May 2013 12:55:23 +0000</pubDate><guid>https://valouille.github.io/2013/05/compiler-un-paquet-debian-dkms-pour-un-module-noyau/</guid><description>Voici un exemple, pour le module wrapper qui permet de corriger la faille CVE-2013-2094 qui peut être exploitée avec l’outil semtex.c
Il faut installer les dépendances suivantes :
apt-get install debhelper dkms linux-headers-`uname -r` Puis on télécharge les sources du module dans /urs/src:
cd /usr/src wget https://www.develer.com/~arighi/linux/fix/CVE-2013-2094/perf-bug-fix.tar.gz tar xvzf perf-bug-fix.tar.gz Il faut nommer le dossier en utilisant la syntaxe « module-version »
mv perf-bug-fix wrapper-0.1 Puis on se place dans le dossier</description></item><item><title>Installer xdiff sous Debian avec PHP 5.4</title><link>https://valouille.github.io/2013/05/installer-xdiff-sous-debian-avec-php-5-4/</link><pubDate>Mon, 06 May 2013 09:54:55 +0000</pubDate><guid>https://valouille.github.io/2013/05/installer-xdiff-sous-debian-avec-php-5-4/</guid><description>Voici un paquet permettant d’installer l’extension xdiff sous Debian :
Télécharger php5-xdiff-5.4-1.5.2-1+awh_amd64.deb.tar.gz et l’installer :
wget https://blog.valouille.fr/wp-content/uploads/2013/05/php5-xdiff-5.4-1.5.2-1+awh_amd64.deb.tar.gz tar xvzf php5-xdiff-5.4-1.5.2-1+awh_amd64.deb.tar.gz dpkg -i php5-xdiff-5.4-1.5.2-1+awh_amd64.deb On vérifie qu’il est bien présent :
# php -r &amp;#34;phpinfo();&amp;#34; | grep xdiff /etc/php5/cli/conf.d/20-xdiff.ini xdiff xdiff support =&amp;gt; enabled libxdiff version =&amp;gt; LibXDiff v0.23 by Davide Libenzi &amp;lt;davide@xmailserver.org&amp;gt;</description></item><item><title>Afficher les « grants » de tous les utilisateurs mySQL</title><link>https://valouille.github.io/2013/05/afficher-les-grants-de-tous-les-utilisateurs-mysql/</link><pubDate>Thu, 02 May 2013 13:49:38 +0000</pubDate><guid>https://valouille.github.io/2013/05/afficher-les-grants-de-tous-les-utilisateurs-mysql/</guid><description>Pour afficher tous les droits de tous les utilisateur d’un serveur mySQL, il faut créer une procédure. Pour cela, dans le prompt de mySQL, il suffit de taper :
USE mysql; DELIMITER // CREATE PROCEDURE showAllGrants() BEGIN DECLARE done INT DEFAULT 0; DECLARE theUser CHAR(16); DECLARE theHost CHAR(60); DECLARE cur1 CURSOR FOR SELECT user, host FROM mysql.user; DECLARE CONTINUE HANDLER FOR SQLSTATE &amp;#39;02000&amp;#39; SET done = 1; OPEN cur1; REPEAT FETCH cur1 INTO theUser, theHost; IF NOT done THEN SET @sql := CONCAT(&amp;#39;SHOW GRANTS FOR &amp;#39;, QUOTE(theUser), &amp;#39;@&amp;#39;, QUOTE(theHost)); PREPARE grantStatement FROM @sql; EXECUTE grantStatement; DROP PREPARE grantStatement; END IF; UNTIL done END REPEAT; CLOSE cur1; END// DELIMITER ; Pour lancer la procédure, on tape :</description></item><item><title>Résoudre les problèmes Grub liés à Grsec</title><link>https://valouille.github.io/2013/04/resoudre-les-problemes-grub-lies-a-grsec/</link><pubDate>Tue, 30 Apr 2013 15:42:30 +0000</pubDate><guid>https://valouille.github.io/2013/04/resoudre-les-problemes-grub-lies-a-grsec/</guid><description>Lorsque l’on utilise un noyau Grsec et que l’on souhaite faire un « update-grub », les erreurs suivantes peuvent se manifester :
# update-grub Killed Killed Generating grub.cfg ... Killed Cela se matérialise comme ceci dans les logs kernel :
PAX: From 10.0.87.1: execution attempt in: &amp;lt;anonymous mapping&amp;gt;, 3c2cfe2a000-3c2cfe40000 3fffffe9000 PAX: terminating task: /usr/sbin/grub-probe(grub-probe):30554, uid/euid: 0/0, PC: 000003c2cfe3eca8, SP: 000003c2cfe3ec58 PAX: bytes at PC: 41 bb 70 40 40 00 49 ba a0 ec e3 cf c2 03 00 00 49 ff e3 00 PAX: bytes at SP-8: 0000000000000006 0000000000401d57 0000000000000000 0000000000622aa0 000003c2cfe3eca8 0000000000404196 0000000000000000 000003c2cfe3f025 000003c2cfe3ee18 0000000000403edd 000000000041a070 grsec: From 10.</description></item><item><title>Résoudre les erreurs Grsec avec un Apache ITK</title><link>https://valouille.github.io/2013/04/resoudre-les-erreurs-grsec-avec-un-apache-itk/</link><pubDate>Tue, 30 Apr 2013 15:21:26 +0000</pubDate><guid>https://valouille.github.io/2013/04/resoudre-les-erreurs-grsec-avec-un-apache-itk/</guid><description>Grsec utilise par défaut les GID 1002, 1003, 1004 et 1005. Cela peut empêcher certaines applications de fonctionner, par exemple un Apache ITK configuré avec des GID utilisés par grsec. Les erreurs logguées dans le kernel ressemblent à ça :
kernel: grsec: From IP.IP.IP.IP: denied connect() by /usr/sbin/apache2[apache2:21077] uid/euid:1003/1003 gid/egid:1003/1003, parent /usr/sbin/apache2[apache2:21072] uid/euid:0/0 gid/egid:0/0 Il y a deux solutions, soit on désactive les fonctions qui nous embêtent :
sysctl kernel.grsecurity.socket_all= sysctl kernel.</description></item><item><title>Ajouter le hostname du serveur dans les headers Apache</title><link>https://valouille.github.io/2013/04/ajouter-le-hostname-du-serveur-dans-les-headers-apache/</link><pubDate>Tue, 30 Apr 2013 14:53:34 +0000</pubDate><guid>https://valouille.github.io/2013/04/ajouter-le-hostname-du-serveur-dans-les-headers-apache/</guid><description>Cela peut être pratique dans le cas où on utilise un cluster de serveur Apache de voir quel est le nom du serveur qui a servi la requête, pour du debug par exemple. Voici la procédure :
Tout d’abord il faut activer le module headers :
a2enmod headers Puis on ajoute la ligne suivante au fichier /usr/sbin/apache2ctl afin de générer une variable d’environnement :
export HOSTNAME=`hostname` Enfin, il faut ajouter les deux lignes suivantes à la fin du fichier /etc/apache2/apache2.</description></item><item><title>Voir le switch ainsi que le port sur lequel une machine est branchée avec tcpdump</title><link>https://valouille.github.io/2013/04/voir-le-switch-ainsi-que-le-port-sur-lequel-une-machine-est-branchee-avec-tcpdump/</link><pubDate>Thu, 18 Apr 2013 15:40:03 +0000</pubDate><guid>https://valouille.github.io/2013/04/voir-le-switch-ainsi-que-le-port-sur-lequel-une-machine-est-branchee-avec-tcpdump/</guid><description>Une alternative à cdpr consite à utiliser tcpdump pour lire les informations contenues dans les trames CDP. En effet, cdpr est gourmand en ressources et est assez lent. Voici ce que l’on peut faire avec tcpdump :
tcpdump -nn -v -i eth0 -s 1500 -c 1 &amp;#39;ether[20:2] == 0x2000&amp;#39; tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 1500 bytes 15:37:08.888679 CDPv2, ttl: 180s, checksum: 692 (unverified), length 373 Device-ID (0x01), length: 7 bytes: &amp;#39;sw02.</description></item><item><title>Installer Puppet 2.6 sous Debian 3.1 Sarge et Etch</title><link>https://valouille.github.io/2013/03/installer-puppet-2-6-sous-debian-3-1-sarge-et-etch/</link><pubDate>Thu, 28 Mar 2013 12:23:15 +0000</pubDate><guid>https://valouille.github.io/2013/03/installer-puppet-2-6-sous-debian-3-1-sarge-et-etch/</guid><description>A l’installation de puppet sous Debian Sarge, on se retrouve avec l’erreur suivante :
err: /File[/var/lib/puppet/lib]: Failed to generate additional resources using &amp;#39;eval_generate&amp;#39;: unknown message digest algorithm err: /File[/var/lib/puppet/lib]: Could not evaluate: unknown message digest algorithm Could not retrieve file metadata for puppet://bushmills.nexen.net/plugins: unknown message digest algorithm Il s’agit d’un bug de la libssl0.9.8, comme on le voit dans les bug reports suivants : #648285, #544819, ou #541735
Sous Debian Sarge, c’est la version 0.</description></item><item><title>Résoudre l'erreur HTTP 414 dans puppet</title><link>https://valouille.github.io/2013/03/resoudre-lerreur-http-414-dans-puppet/</link><pubDate>Tue, 19 Mar 2013 16:36:34 +0000</pubDate><guid>https://valouille.github.io/2013/03/resoudre-lerreur-http-414-dans-puppet/</guid><description>Avec la version 2.6 de puppet utilisée en Squeeze, on peut rencontrer l’erreur suivante :
err: Could not retrieve catalog from remote server: Error 414 on SERVER: &amp;lt;!DOCTYPE HTML PUBLIC &amp;#34;-//IETF//DTD HTML 2.0//EN&amp;#34;&amp;gt; &amp;lt;html&amp;gt;&amp;lt;head&amp;gt; &amp;lt;title&amp;gt;414 Request-URI Too Large&amp;lt;/title&amp;gt; &amp;lt;/head&amp;gt;&amp;lt;body&amp;gt; &amp;lt;h1&amp;gt;Request-URI Too Large&amp;lt;/h1&amp;gt; &amp;lt;p&amp;gt;The requested URL&amp;#39;s length exceeds the capacity limit for this server.&amp;lt;br /&amp;gt; Ce bug est résolu dans la version 2.7 de puppet.
On peut soit mettre à jour le client via les backports :</description></item><item><title>Media player qui ne fonctionne pas dans ownCloud 5</title><link>https://valouille.github.io/2013/03/media-player-qui-ne-fonctionne-pas-dans-owncloud-5/</link><pubDate>Fri, 15 Mar 2013 15:32:50 +0000</pubDate><guid>https://valouille.github.io/2013/03/media-player-qui-ne-fonctionne-pas-dans-owncloud-5/</guid><description>Sur la toute nouvelle version d’ownCloud (5.0.0) le ‘Dropbox like libre’, le media player ne fonctionne pas. Il est impossible de lire de la musique. Dans firebug, j’ai trouvé l’erreur suivante :
{&amp;#34;data&amp;#34;:{&amp;#34;message&amp;#34;:&amp;#34;Token expired. Please reload page.&amp;#34;},&amp;#34;status&amp;#34;:&amp;#34;error&amp;#34;} En fait, il faut modifier le fichier apps/media/ajax/api.php tel que ci-dessous :
\OCP\JSON::checkAppEnabled(&amp;#39;media&amp;#39;); \OCP\JSON::checkLoggedIn(); -\OCP\JSON::callCheck(); error_reporting(E_ALL); //no script error reporting because of getID3 @@ -43,6 +42,7 @@ if ($arguments[&amp;#39;action&amp;#39;]) { switch ($arguments[&amp;#39;action&amp;#39;]) { case &amp;#39;delete&amp;#39;: + \OCP\JSON::callCheck(); $path = $arguments[&amp;#39;path&amp;#39;]; $collection-&amp;gt;deleteSongByPath($path); $paths = explode(PATH_SEPARATOR, \OCP\Config::getUserValue(\OCP\USER::getUser(), &amp;#39;media&amp;#39;, &amp;#39;paths&amp;#39;, &amp;#39;&amp;#39;));</description></item><item><title>Se connecter à un VPN IPSEC avec vpnc</title><link>https://valouille.github.io/2013/02/se-connecter-a-un-vpn-ipsec-avec-vpnc/</link><pubDate>Wed, 20 Feb 2013 13:46:20 +0000</pubDate><guid>https://valouille.github.io/2013/02/se-connecter-a-un-vpn-ipsec-avec-vpnc/</guid><description>Pour se connecter à un VPN IPSec, on peut utiliser l’outil libre vpnc. Voici comment le configurer.
Installer vpnc et netcat:
apt-get install vpnc netcat Ajouter les lignes suivantes dans le fichier /etc/vpnc/default.conf :
IPSec gateway &amp;lt;IP du VPN&amp;gt; IPSec ID tgroup1 IPSec secret Start1 IKE DH Group dh2 Vendor cisco Xauth username &amp;lt;Nom d&amp;#39;utilisateur&amp;gt; Xauth password &amp;lt;Mot de passe&amp;gt; Script /etc/vpnc/vpnc-script Lancer vpnc :
vpnc /etc/vpnc/default.conf Si ca ne fonctionne pas, ajouter aussi l’option suivante a /etc/vpnc/default.</description></item><item><title>Concaténer deux fichiers, ou les merger une ligne sur deux</title><link>https://valouille.github.io/2013/02/concatener-deux-fichiers-ou-les-merger-une-ligne-sur-deux/</link><pubDate>Tue, 19 Feb 2013 15:26:19 +0000</pubDate><guid>https://valouille.github.io/2013/02/concatener-deux-fichiers-ou-les-merger-une-ligne-sur-deux/</guid><description>Parfois, on a une liste dans les mains sous forme de fichier texte, et on doit insérer du contenu à la fin, ou une ligne sur deux. Pour cela, on peut utiliser la commande « paste ».
Prennons le cas de ces deux fichiers :
% cat fichier1.txt 111 222 333 % cat fichier2.txt aaa bbb ccc Si on veut la concaténer, voici la commande :
% paste -d &amp;#39; &amp;#39; fichier1.</description></item><item><title>Empêcher la suppression/modification d'un fichier par root</title><link>https://valouille.github.io/2013/02/empecher-la-suppression-dun-fichier-pour-root/</link><pubDate>Tue, 19 Feb 2013 15:09:38 +0000</pubDate><guid>https://valouille.github.io/2013/02/empecher-la-suppression-dun-fichier-pour-root/</guid><description>Pour empêcher la modification ou la suppression d’un fichier, y compris pour root, on peut utiliser la commande « chattr » qui permet de mettre en place des attributs avancés sur les fichiers.
Pour bloquer un fichier : chattr +i fichier Pour voir les attributs avancés d’un fichier : lsattr ----i----------- ./fichier Pour débloquer un fichier chattr -i fichier</description></item><item><title>Installation d'un serveur OpenVPN et automatisation</title><link>https://valouille.github.io/2013/02/installation-dun-serveur-openvpn-et-automatisation/</link><pubDate>Mon, 18 Feb 2013 22:27:39 +0000</pubDate><guid>https://valouille.github.io/2013/02/installation-dun-serveur-openvpn-et-automatisation/</guid><description>OpenVPN est un logiciel permettant de monter un serveur VPN SSL. Le but est de créer un LAN qui passe sur le WAN, et dont les données sont cryptées. Cela est utile quand on ne souhaite pas ouvrir de ports à partir de tout internet par exemple. Ce tutorial présente l’installation d’un serveur OpenVPN avec une identification par certificats, qui sont uniques à chaque personne.
Installation d’un serveur OpenVPN Il faut installer le paquet OpenVPN</description></item><item><title>Supprimer les mails reçus en double avec Pigeonhole et Dovecot 2</title><link>https://valouille.github.io/2013/02/supprimer-les-mails-recus-en-double-avec-pigeonhole-et-dovecot-2/</link><pubDate>Mon, 18 Feb 2013 15:15:39 +0000</pubDate><guid>https://valouille.github.io/2013/02/supprimer-les-mails-recus-en-double-avec-pigeonhole-et-dovecot-2/</guid><description>Si on est inscrit à deux mailing-lists, et qu’un mail est envoyé à ces deux mailing-lists, alors on va le recevoir deux fois. Ou même si on est simplement en copie du mail envoyé à la mailing list. Il est possible de supprimer ces doublons, en se basant sur vnd.dovecot.duplicate. C’est une extension sieve. Le principe est que chaque mail contient un « msgid » unique, et le plugin se base sur cet ID afin de détecter les doublons.</description></item><item><title>Paquet Debian Bullet pour compiler e17</title><link>https://valouille.github.io/2013/02/paquet-debian-bullet-pour-e17/</link><pubDate>Mon, 18 Feb 2013 11:05:05 +0000</pubDate><guid>https://valouille.github.io/2013/02/paquet-debian-bullet-pour-e17/</guid><description>Lors de la compilation de enlightenment, j’ai eu l’erreur suivante :
configure: Start EPhysics checks configure: error: pkg-config missing bullet &amp;gt;= 2.80 Bullet est une librairie physique.
Bullet n’étant pas disponible sous Debian, je l’ai compilé. Pour l’installer, il faut le télécharger ici : bullet-2.81_2.81+rev2613-1_amd64.deb.tar.gz
tar xvzf bullet-2.81_2.81+rev2613-1_amd64.deb.tar.gz dpkg -i bullet-2.81_2.81+rev2613-1_amd64.deb Pour l’installer à la main :
apt-get install cmake freeglut3-dev wget https://bullet.googlecode.com/files/bullet-2.81-rev2613.tgz tar xvzf bullet-2.81-rev2613.tgz cd bullet-2.81-rev2613 cmake -D BUILD_SHARED_LIBS=true .</description></item></channel></rss>